import{r as d,c as w,u as N,j as f,a as s,m as P,Q as n,$ as j,a0 as D,L}from"./index.6c9b87f9.js";import{b as v,P as k}from"./index.550a4036.js";import{I as z}from"./index.6f1cfc5f.js";import"./CloseOutlined.11b2fdea.js";import"./index.c816b7fc.js";import"./type.d47588eb.js";import"./Compact.2f55ebc9.js";import"./index.17206201.js";import"./motion.04f77c3d.js";import"./roundedArrow.6f9d2b2b.js";import"./button.9d20bfc0.js";const B=()=>{const[t,p]=d.exports.useState(""),[c,u]=d.exports.useState(""),[y,o]=d.exports.useState(!1),b=w(),[x,F]=d.exports.useState(0),{user:l}=N(e=>e.user),g=localStorage.getItem("token"),r=v(t==null?void 0:t.size),S=v(l==null?void 0:l.maxlimit),U=l==null?void 0:l.existlimit,h=(parseFloat(U)+parseFloat(r==null?void 0:r.value)).toFixed(2),_=()=>{if(o(!0),t.type!="video/mp4"&&t.type!="audio/mpeg"){n.error("Unsupported Files Formates you select..."),o(!1),p(null);return}if(h<S){const e=new FormData;e.append("file",t),e.append("upload_preset","whatsup_clone"),e.append("cloud_name","cooldeveloper"),e.append("allowedFormats",["jpg","png","pdf"]),j.post("https://api.cloudinary.com/v1_1/cooldeveloper/video/upload",e,{onUploadProgress:a=>{F(Math.round(a.loaded/a.total*100))}}).then(a=>{console.log(a.data),D(g,a.data.public_id,a.data.secure_url,t.type,c,h,r==null?void 0:r.value).then(i=>{console.log(i,"res"),i&&(n.success("Data Uploaded SuccessFully"),o(!1),L(g).then(m=>{b({type:"load",payload:m.data})}).catch(m=>{n.error(m.response.data.error)}),u(""),p("")),o(!1)}).catch(i=>{console.log(i),n.error(i.response.data.error),o(!1)})}).catch(a=>{console.log(a),o(!1)})}else n.error("Your File size is more then your available storage"),o(!1),u(""),p([])};return f("div",{className:"videofile",children:[s("h4",{children:"Upload Video and Audio Files"}),f("div",{className:"fg",children:[s("label",{children:"Title"}),s(z,{className:"input",placeholder:"Enter Your Post Title",value:c,onChange:e=>u(e.target.value)})]}),s("input",{type:"file",multiple:!0,onChange:e=>p(e.target.files[0])}),s(k,{percent:x,className:"bar"}),s("button",{disabled:c==""||t=="",onClick:_,className:"btn btn-sm btn-primary",children:y?s(P,{}):"Upload"})]})};export{B as default};
